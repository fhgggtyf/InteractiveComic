function init() {    
  var $headerFixed = $('.header-fixed'),
    winHeight = $(window).height(), 
    docHeight = $('.comic').height(),
    progressBar = $('progress'),
    progressMax = 0;
    progressValue = 0;


  // hide navbar on load
  // $headerFixed.addClass('offscreen');


  // disappearing navbar
  var lastScrollTop = 0;
  var headerHeight = $headerFixed.outerHeight();
  $(window).scroll(function(event){
    var st = $(this).scrollTop();
    if (st > lastScrollTop) { $headerFixed.addClass('offscreen'); } 
    else { $headerFixed.removeClass('offscreen'); }
    if (st <= 50) { $headerFixed.addClass('at-top'); } 
    else { $headerFixed.removeClass('at-top'); }
    lastScrollTop = st;
  });


  // external links to target="_blank"
  $.expr[':'].external = function(obj){
    return !obj.href.match(/^mailto\:/)
           && (obj.hostname != location.hostname)
           && !obj.href.match(/^javascript\:/)
           && !obj.href.match(/^$/)
  };

  $('a:external').attr('target', '_blank');


  // reading progress
  progressMax = docHeight - winHeight;
  progressBar.attr('max', progressMax);

  function updateProgress() {
   progressValue = $(window).scrollTop();
   progressBar.attr('value', progressValue);    
  }

  $(document).on('scroll', function(){updateProgress() });


  // resize handler for scrollbar
  $(window).on('resize', function() {
    winHeight = $(window).height(),
    docHeight = $(document).height();
    progressMax = docHeight - winHeight;
    progressBar.attr('max', progressMax);
    updateProgress();
  });


  // credits
  function showCredits() {
    $('.credits-text').show(0);
    $('.credits-toggle').hide(0);
  }

  $('.credits-toggle').click(function(e) {
    showCredits();
    e.preventDefault();
  });

  $('.js-credits-link').click(function(e) {
    showCredits();
    var targetSelector = $(this).attr('href');
    var $targetElem = $(targetSelector);
    if ($targetElem.length) {
      $('body, html').scrollTop( $targetElem.offset().top );
    } else if ( $('#credits').length ) {
      $('body, html').scrollTop( $('#credits').offset().top );
    }
    e.preventDefault();    
  });


  // back to top
  $('a[href="#top"]').click(function(e) {
    $('body, html').scrollTop(0);
    e.preventDefault();
  });

}

window.onload = init;